-- View: sup_orders_for_sms--DROP VIEW sup_orders_for_sms;CREATE OR REPLACE VIEW sup_orders_for_sms AS 	SELECT 		m.id AS material_id,		m.name AS material_descr,		sp.id AS supplier_id,		sp.name AS supplier_descr,		sp.tel AS tel,		sp.tel2 AS tel2,		round(o.quant) AS quant,				replace(			replace(				replace(					replace(						templ.pattern,'[date]',date8_descr((now()::date+'1 day'::interval)::date)					),					'[quant]',round(o.quant)::text				),				'[mat]',m.name::text			),			'[sup]',sp.name::text		)		AS mes_text	FROM supplier_orders o	LEFT JOIN raw_materials m ON m.id=o.material_id	LEFT JOIN suppliers sp ON sp.id=o.supplier_id	LEFT JOIN sms_patterns AS templ		ON templ.sms_type='procur' AND templ.lang_id=sp.lang_id	WHERE o.date=now()::date+'1 day'::interval AND tel IS NOT NULL AND tel<>''	;ALTER TABLE sup_orders_for_sms  OWNER TO beton;